<!DOCTYPE html>
<html lang="en">
    
    <head>

    	<title>Finding Your Toronto</title>

    	<!-- Make responsive  -->
    	<meta name="viewport" content="width=device-width, initial-scale=1">

    	<!-- Include Leaflet CSS file -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
		   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
		   crossorigin="">

		<!-- Include Leaflet JavaScript -->
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
		   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
		   crossorigin=""></script>

		 <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.1/dist/chart.min.js"></script>

		<!-- Include Custom CSS file -->
		<link rel="stylesheet" href="css.css">
		
		<!-- Include GeoJson data -->
		<script src="GeoJsonData/reclassData.geojson"></script>
		<script src="GeoJsonData/attractionsData.geojson"></script>
		<script src="GeoJsonData/schoolsData.geojson"></script>
		<script src="GeoJsonData/postSecData.geojson"></script>
		<script src="GeoJsonData/healthData.geojson"></script>
		<script src="GeoJsonData/worshipData.geojson"></script>
		<script src="GeoJsonData/subData.geojson"></script>

    </head>

    <body>

    	<!-- Side NavBar -->
    	<div class="sideNav">
    		<button></button>
			<button class="tablinks" onclick="openCity(event,'instructions')">Instructions</button>
			<button class="tablinks" onclick="openCity(event,'weightsInterface')">Weights</button>
			<button class="tablinks" onclick="openCity(event,'statistics')">Statistics</button>
    	</div>

    	<!-- Instructions -->
    	<div id="instructions" class="tabcontent">
    		<h1>Finding Your Toronto</h1>
    		<p>This is the what to do things/ instuctions.</p>
    	</div>

    	<!-- Weights Interface -->
    	<div id="weightsInterface" class="tabcontent">
    		<h1>Weights Interface</h1>

    		<form>

    			<label for="newSubmit">Layer Name</label>
	    		<input type="text" step="0.01" min="0" max="1" id="newSubmit" placeholder="">

    			<!-- weights input interface -->
				<label for="crime">Low levels of crime</label>
	    		<input type="number" step="0.01" min="0" max="1" id="crime" placeholder="">

	    		<label for="price">Low average home price</label>
	    		<input type="number" step="0.01" min="0" max="1" id="price" placeholder="">

	    		<label for="popDensity">Low population density</label>
	    		<input type="number" step="0.01" min="0" max="1" id="popDensity" placeholder="">

	    		<label for="attractions">Proximity to attractions</label>
	    		<input type="number" step="0.01" min="0" max="1" id="attractions" placeholder="">

	    		<label for="schools">Proximity to schools</label>
	    		<input type="number" step="0.01" min="0" max="1" id="schools" placeholder="">

	    		<label for="postSec">Proximity to post-secondary institutions</label>
	    		<input type="number" step="0.01" min="0" max="1" id="postSec" placeholder="">

				<label for="healthService">Proximity to health services</label>
	    		<input type="number" step="0.01" min="0" max="1" id="healthService" placeholder="">

	    		<label for="religiousInsti">Proximity to religious institutions</label>
	    		<input type="number" step="0.01" min="0" max="1" id="religiousInsti" placeholder="">

	    		<label for="subway">Proximity to the subway</label>
	    		<input type="number" step="0.01" min="0" max="1" id="subway" placeholder="">

	    		
	    		<!-- submit button -->
	    		<button id="btn" type="button" onclick="getWeights()">Submit</button>

    		</form>

    	</div>

		<!-- Map statistics -->
    	<div id="statistics" class="tabcontent">
    		<h1>Statistics</h1>
    		<!-- Crime Chart -->
			<canvas id="crimeStats" width="400" height="400"></canvas>

			<!-- Race Chart -->
			<canvas id="raceStats" width="400" height="400"></canvas>

			<!-- Age Chart -->
			<canvas id="ageStats" width="400" height="400"></canvas>
    		
    	</div>

    	<!-- Where the map will be displayed -->
    	<div id="mapid"></div>

 		<!-- Include Custom JavaScript file -->
		<script src="script.js"></script>

    	<script>

 		// map initialization
 		var mymap = L.map('mapid').setView([43.664643050786125, -79.3923568725586], 11);

 		//add base map
 		var basemap = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
		    attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',});
		basemap.addTo(mymap);

		
		// create Toronto neighbourhoods layer 
		var TOboarders = L.geoJson(tableData, {
							style: mapStyle,
							onEachFeature: onEachFeature});
		
		// create simple objects with key (text for the layer) /value (reference to the layer) pairs
		var submittedLayers = {
		    "Toronto neighbourhood Boarders": TOboarders,
		};

		// pointsLayers and their pop-ups
		var attractions = L.geoJSON(attractionsData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.category + "</i><br><br>" + 
    							feature.properties.descriptio)}});
			
		var schools = L.geoJSON(schoolsData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.type + "</i> - " + 
    							feature.properties.board)}});

		var postSec = L.geoJSON(postSecData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.type + "</i>")}});

		var health = L.geoJSON(healthData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br><br>" +
    							"<i>Accessibility: </i><br>" + feature.properties.accessibility + "<br><br>" +
								"<i>Languages: </i><br>" + feature.properties.languages + "<br><br>" + 
    							"<i>Description: </i><br>" + feature.properties.description )}});

		var worship = L.geoJSON(worshipData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.ORGANIZATI + "</b><br>" +
    							"<i>" + feature.properties.FAITH + "</i>")}});

		var subway = L.geoJSON(subData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.ROUTE_NAME + "</b>")}});



		// create simple objects with key (text for the layer) /value (reference to the layer) pairs
		var overlayMaps = {
		    "Attractions": attractions,
		    "Schools": schools,
		    "Post-secondary Institutions": postSec,
		    "Health Care Services": health,
		    "Worship Institutions": worship,
		    "Subway": subway,
		};

		// add Layers/ledgend
		var addLadgend = L.control.layers(submittedLayers,overlayMaps)
		addLadgend.addTo(mymap);

		var crimeChart;
		var raceChart;
		var ageChart;

		// display neighbourhood info
		var info = L.control({position: 'bottomright'});

		// create a div with a class "info"
		info.onAdd = function (mymap) {
		    this._div = L.DomUtil.create('div', 'info'); 
		    this.update();
		    return this._div;
		};

		// method that we will use to update the control based on feature properties passed
		info.update = function (props) {
		    this._div.innerHTML = (props ?
				"<b>" + props.hoodName + " </b><br>" +
				"<i> Suitability: </i>" + props.FinalRecla + "%<br>" +
				"<i> Levels of Crime Ranking: </i>" + props.crimeRank + "<br>" +
				"<i> Average Home Price: $</i>" + props.avgPrice + "<br>" +
				"<i> Population Density: </i>" + props.popDensity + " people / km<sup>2</sup>"
				: "");
		};

		info.addTo(mymap);

 		</script>


   </body>
</html>   	 