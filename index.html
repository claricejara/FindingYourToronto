<!DOCTYPE html>
<html lang="en">
    
    <head>

    	<title>Finding Your Toronto</title>

    	<!-- Make responsive  -->
    	<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Bootstap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" 
			integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" 
			crossorigin="anonymous">

		<!-- JavaScript -->
	    <!-- jQuery, Popper.js, Bootstrap JS -->
	    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" 
			integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" 
			crossorigin="anonymous"></script>

    	<!-- Include Leaflet CSS file -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
		   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
		   crossorigin="">

		<!-- Include Leaflet JavaScript -->
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
		   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
		   crossorigin=""></script>

		<script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.1/dist/chart.min.js"></script>

		<!-- Include Custom CSS file -->
		<link rel="stylesheet" href="css.css">
		
		<!-- Include GeoJson data -->
		<script src="GeoJsonData/reclassData.geojson"></script>
		<script src="GeoJsonData/attractionsData.geojson"></script>
		<script src="GeoJsonData/schoolsData.geojson"></script>
		<script src="GeoJsonData/postSecData.geojson"></script>
		<script src="GeoJsonData/healthData.geojson"></script>
		<script src="GeoJsonData/worshipData.geojson"></script>
		<script src="GeoJsonData/subData.geojson"></script>

    </head>

	<header>

    	<!-- NavBar -->
    	<div class="NavBar row fixed-top text-center">

			<h1 class="col-6">Finding<wbr> Your<wbr> Toronto</h1>

			<button class="tablinks col-2" onclick="openTab(event,'instructions')">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
				</svg>
				<p>Instructions</p>
			</button>

			<button class="tablinks col-2" onclick="openTab(event,'weightsInterface')">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
					<path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
					<path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
				</svg>
				<p>Weights</p>
			</button>

			<button class="tablinks col-2" onclick="openTab(event,'statistics')">
				<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-graph-up" viewBox="0 0 16 16">
					<path fill-rule="evenodd" d="M0 0h1v15h15v1H0V0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5z"/>
				</svg>
				<p>Statistics</p>
			</button>

    	</div>
	
	</header>

	<body>

		<!-- Instructions  -->
		<div id="instructions" class="tabcontent col-12 col-lg-4">
			<p>
				<i><b>Welcome to Finding Your Toronto!</b></i> This is a tool designed to help people in 
				deciding the ideal neighbourhood for them to live in based on 
				socioeconomic, cultural, and spatio-temporal dimensions. It automates 
				the process of site suitability analysis, ranking neighbourhoods 
				in Toronto using trusted data from the official 
				<a href="https://open.toronto.ca/">City of Toronto Open Data Portal</a>
				. To find your Toronto, follow the steps below:
			</p>

			<ol>
				<li>
					In the weights tab, input a new layer name in order to add the 
					generated map to the legend below
				</li>
				<li>
					Use the sliders to input the level of importance each factor
					holds in your ideal neighbourhood search
				</li>
				<li>
					Click submit, and select your new layer from the legend to see 
					the generated map
				</li>
				<li>
					Hover and click on a neighbourhood to see its data, 
					for more information open the statistics tab
				</li>
				<li>
					Repeat until you find your ideal Toronto neighbourhood
				</li>
			</ol>
		</div>


    	<!-- Weights Interface -->
    	<div id="weightsInterface" class="tabcontent col-12 col-lg-4">
			<div class="row">
				<input id="newSubmit" type="text" placeholder="New Layer Name">
			</div>

			<div class="row">
				<label for="crime">Low levels of crime:</label>
				<span id="crimeVal" class="sliderValue">10</span>
				<input id="crime" class="slider" type="range" min="0" max="10" value="0" >
			</div>

			<div class="row">
				<label for="price">Low average home price:</label>
				<span id="priceVal" class="sliderValue">10</span>
				<input id="price" class="slider" type="range" min="0" max="10" value="0">				
			</div>

			<div class="row">
				<label for="popDensity">Low population density:</label>
				<span id="popVal" class="sliderValue">10</span>
				<input id="popDensity" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="attractions">Proximity to attractions:</label>
				<span id="attractionsVal" class="sliderValue">10</span>
				<input id="attractions" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="schools">Proximity to schools:</label>
				<span id="schoolsVal" class="sliderValue">10</span>
				<input id="schools" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="postSec">Proximity to post-secondary institutions:</label>
				<span id="postSecVal" class="sliderValue">10</span>
				<input id="postSec" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="healthService">Proximity to health services:</label>
				<span id="healthVal" class="sliderValue">10</span>
				<input id="healthService" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="religiousInsti">Proximity to religious institutions:</label>
				<span id="religiousVal" class="sliderValue">10</span>
				<input id="religiousInsti" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<div class="row">
				<label for="subway">Proximity to the subway:</label>
				<span id="subwayVal" class="sliderValue">10</span>
				<input id="subway" class="slider" type="range" min="0" max="10" value="0">
			</div>

			<!-- submit button  -->
			<button id="btn" type="button" onclick="getWeights()">Submit</button>

		</div>

		<!-- Map statistics -->
    	<div id="statistics" class="tabcontent col-lg-4">

    		<!-- Crime Chart -->
			<div class="charts">
				<canvas id="crimeStats"></canvas>
			</div>
			
			<!-- Age Chart -->
			<div class="charts">
				<canvas id="ageStats"></canvas>
			</div>

			<!-- Race Chart -->
			<div class="charts">
				<canvas id="raceStats"></canvas>
			</div>

    	</div>

    	<!-- Where the map will be displayed -->
    	<div id="mapid" class="col-12 col-lg-8 m-0"></div>

 		<!-- Include Custom JavaScript file -->
		<script src="script.js"></script>

    	<script>

 		// map initialization
 		var mymap = L.map('mapid').setView([43.664643050786125, -79.3923568725586], 11);

 		//add base map
 		var basemap = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
		    attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',});
		basemap.addTo(mymap);

		
		// create Toronto neighbourhoods layer 
		var TOboarders = L.geoJson(tableData, {
							style: mapStyle,
							onEachFeature: onEachFeature});
		
		// create simple objects with key (text for the layer) /value (reference to the layer) pairs
		var submittedLayers = {
		    "Toronto neighbourhood Boarders": TOboarders,
		};

		// pointsLayers and their pop-ups
		var attractions = L.geoJSON(attractionsData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.category + "</i><br><br>" + 
    							feature.properties.descriptio)}});
			
		var schools = L.geoJSON(schoolsData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.type + "</i> - " + 
    							feature.properties.board)}});

		var postSec = L.geoJSON(postSecData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br>" +
    							"<i>" + feature.properties.type + "</i>")}});

		var health = L.geoJSON(healthData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.name + "</b><br><br>" +
    							"<i>Accessibility: </i><br>" + feature.properties.accessibility + "<br><br>" +
								"<i>Languages: </i><br>" + feature.properties.languages + "<br><br>" + 
    							"<i>Description: </i><br>" + feature.properties.description )}});

		var worship = L.geoJSON(worshipData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.ORGANIZATI + "</b><br>" +
    							"<i>" + feature.properties.FAITH + "</i>")}});

		var subway = L.geoJSON(subData, {
			onEachFeature: function (feature, layer) {
    			layer.bindPopup("<b>" + feature.properties.ROUTE_NAME + "</b>")}});



		// create simple objects with key (text for the layer) /value (reference to the layer) pairs
		var overlayMaps = {
		    "Attractions": attractions,
		    "Schools": schools,
		    "Post-secondary Institutions": postSec,
		    "Health Care Services": health,
		    "Worship Institutions": worship,
		    "Subway": subway,
		};

		// add Layers/legend
		legend.addTo(mymap);

		var addLagend = L.control.layers(submittedLayers,overlayMaps)
		addLagend.addTo(mymap);

		var crimeChart;
		var raceChart;
		var ageChart;

		// display neighbourhood info
		var info = L.control({position: 'bottomleft'});

		// create a div with a class "info"
		info.onAdd = function (mymap) {
		    this._div = L.DomUtil.create('div', 'info'); 
		    this.update();
		    return this._div;
		};

		// method that we will use to update the control based on feature properties passed
		info.update = function (props) {
		    this._div.innerHTML = (props ?
				"<b>" + props.hoodName + " </b><br>" +
				"<i> Suitability: </i>" + props.FinalRecla + "%<br>" +
				"<i> Low Crime Rate Ranking: </i>" + props.crimeRank + "<br>" +
				"<i> Average Home Price: $</i>" + props.avgPrice + "<br>" +
				"<i> Population Density: </i>" + props.popDensity + " people / km<sup>2</sup>"
				: "");
		};

		info.addTo(mymap);

 		</script>
	</body>

	<footer>
		<p> Copyright &#169; 2021 Clarice Jara</p>
	</footer>

</html>   	 